predict_mtum <- function(model, df.test){
  
  ## Factoring Target variable ##
  df.test[,model$targetVariable] <- factor(df.test[,model$targetVariable])
  levels(df.test[,model$targetVariable]) <- c(model$targetNegativeClass, model$targetPositiveClass)
  
  ## Testing a model in this methodology goes as followed:
  #   1) Retrieve the probability of an individual responding when he is not being treated (treatmentVariable = 0).
  #   2) Retrieve the probability of an individual responding when he is being treated with Treatment 1 (treatmentVariable1 = 1).
  #   3) Retrieve the probability of an individual responding when he is being treated with Treatment 2 (treatmentVariable1 = 2).
  
  ## Step 1: Retrieve the probability of an individual responding when he is not being treated (treatmentVariable(s) = 0).
  modelProbs.Control <- extractProb(list(model$model.ct), 
                                    testX = df.test[,model$predictors], 
                                    testY = df.test[,model$targetVariable])
  
  modelProbs.Control.Results <- modelProbs.Control[modelProbs.Control$dataType == "Test",]
  
  ## Step 2: Retrieve the probability of an individual responding when he is being treated with Treatment 1 (treatmentVariable1 = 1).
  modelProbs.Treatment1 <- extractProb(list(model$model.t1), 
                                       testX = df.test[,model$predictors], 
                                       testY = df.test[,model$targetVariable])
  
  modelProbs.Treatment1.Results <- modelProbs.Treatment1[modelProbs.Treatment1$dataType == "Test",]
  
  ## Step 3: Retrieve the probability of an individual responding when he is being treated with Treatment 2 (treatmentVariable2 = 1).
  modelProbs.Treatment2 <- extractProb(list(model$model.t2), 
                                       testX = df.test[,model$predictors], 
                                       testY = df.test[,model$targetVariable])
  
  modelProbs.Treatment2.Results <- modelProbs.Treatment2[modelProbs.Treatment2$dataType == "Test",]
  
  predictions = data.frame(treatment1=numeric(nrow(modelProbs.Treatment1.Results)),
                           treatment2=numeric(nrow(modelProbs.Treatment2.Results)),
                           control=numeric(nrow(modelProbs.Control.Results)))
  
  predictions$treatment1 <- modelProbs.Treatment1.Results[,model$targetPositiveClass]
  predictions$treatment2 <- modelProbs.Treatment2.Results[,model$targetPositiveClass]
  predictions$control <- modelProbs.Control.Results[,model$targetPositiveClass]
  
  return(predictions)
}
